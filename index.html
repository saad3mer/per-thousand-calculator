<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„Ù</title>

<style>
:root{
    --bg:#f3f4f6;
    --card:#ffffff;
    --text:#111827;
    --border:#e5e7eb;
    --main:#2563eb;
}
body.dark{
    --bg:#0f172a;
    --card:#020617;
    --text:#e5e7eb;
    --border:#1e293b;
    --main:#38bdf8;
}

*{box-sizing:border-box}

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:var(--bg);
    color:var(--text);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    direction:rtl;
}

.card{
    background:var(--card);
    width:100%;
    max-width:360px;
    padding:20px;
    border-radius:18px;
    box-shadow:0 15px 30px rgba(0,0,0,.15);
}

.header{
    display:flex;
    justify-content:center;
    margin-bottom:15px;
}

h2{
    margin:0;
    font-size:20px;
}

label{
    display:block;
    margin-top:12px;
    font-weight:bold;
}

input{
    width:100%;
    padding:12px;
    margin-top:6px;
    border-radius:12px;
    border:1px solid var(--border);
    background:transparent;
    color:var(--text);
    font-size:16px;
}

.rate-row{
    display:flex;
    gap:10px;
    margin-top:6px;
}

.buttons{
    display:flex;
    gap:8px;
    flex:1;
}

.buttons button{
    flex:1;
    padding:10px;
    border:none;
    border-radius:12px;
    cursor:pointer;
    font-size:14px;
    background:var(--border);
    color:var(--text);
    transition:.2s;
}

.buttons button.active{
    background:var(--main);
    color:#fff;
}

#customRate{
    width:70px;
    padding:10px;
    border-radius:12px;
    border:1px solid var(--border);
    background:transparent;
    color:var(--text);
    font-size:14px;
    text-align:center;
}

.result{
    margin-top:15px;
    background:rgba(0,0,0,.05);
    padding:12px;
    border-radius:12px;
}

.result div{
    margin-bottom:6px;
}

.copy{
    margin-top:10px;
    width:100%;
    padding:12px;
    border:none;
    border-radius:14px;
    background:var(--main);
    color:#fff;
    font-size:15px;
    cursor:pointer;
    transition:.2s;
}

.copy.copied{
    background:#16a34a;
    animation:pop .3s ease;
}

@keyframes pop{
    0%{transform:scale(1)}
    50%{transform:scale(1.08)}
    100%{transform:scale(1)}
}
</style>
</head>

<body>

<div class="card">
    <div class="header">
        <h2>Ø­Ø³Ø§Ø¨ Ø§Ù„Ø®ØµÙ… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù„Ù</h2>
    </div>

    <label>Ø§Ù„Ù…Ø¨Ù„Øº</label>
    <input type="number" id="amount" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù…Ø¨Ù„Øº">

    <label>Ø§Ø®ØªØ§Ø± Ø§Ù„Ø®ØµÙ…</label>
    <div class="rate-row">
        <div class="buttons">
            <button onclick="setRate(5,this)">5 â€°</button>
            <button onclick="setRate(6,this)">6 â€°</button>
            <button onclick="setRate(8,this)">8 â€°</button>
        </div>

        <input 
            type="number" 
            id="customRate" 
            placeholder="â€°"
            oninput="setCustomRate(this.value)"
        >
    </div>

    <div class="result">
        <div>ğŸ’¸ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…: <b id="discount">0</b></div>
        <div>âœ… Ø§Ù„Ù†Ø§ØªØ¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: <b id="final">0</b></div>
    </div>

    <button class="copy" id="copyBtn" onclick="copyResult()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬</button>
</div>

<script>
// ==================== Dark Mode ====================
window.addEventListener("message", (event) => {
    if(event.data.dark !== undefined){
        document.body.classList.toggle("dark", event.data.dark);
    }
    if(event.data.theme){
        document.body.classList.toggle("dark", event.data.theme === "dark");
    }
});

if(window.parent){
    window.parent.postMessage({requestTheme:true}, '*');
}
// ==================================================

let rate = 0;

const amountInput = document.getElementById("amount");
const discountEl = document.getElementById("discount");
const finalEl = document.getElementById("final");
const buttons = document.querySelectorAll(".buttons button");
const copyBtn = document.getElementById("copyBtn");
const customRateInput = document.getElementById("customRate");

function setRate(val,el){
    rate = val;
    customRateInput.value = "";

    buttons.forEach(b=>b.classList.remove("active"));
    el.classList.add("active");

    calculate();
}

function setCustomRate(val){
    rate = parseFloat(val) || 0;
    buttons.forEach(b=>b.classList.remove("active"));
    calculate();
}

function calculate(){
    const amount = parseFloat(amountInput.value) || 0;
    const discount = amount * (rate / 1000);
    const finalAmount = amount - discount;

    discountEl.textContent = discount.toFixed(2);
    finalEl.textContent = finalAmount.toFixed(2);
}

amountInput.addEventListener("input", calculate);

function copyResult(){
    const text = `Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø¹Ø¯ Ø§Ù„Ø®ØµÙ…: ${finalEl.textContent}`;
    navigator.clipboard.writeText(text);

    copyBtn.classList.add("copied");
    copyBtn.innerHTML = "âœ” ØªÙ… Ø§Ù„Ù†Ø³Ø®";

    setTimeout(()=>{
        copyBtn.classList.remove("copied");
        copyBtn.innerHTML = "ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù†Ø§ØªØ¬";
    },1000);
}
</script>

</body>
</html>
